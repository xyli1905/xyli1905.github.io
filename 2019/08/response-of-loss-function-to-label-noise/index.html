<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Quanta  | science, reflection, projects</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" type="image/png" href="https://xyli1905.github.io/img/cropped-siteicon.png"/>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css" />
    <link rel="stylesheet" href="https://xyli1905.github.io/css/blog.css" />

    
    <style>
        .search {
            position: relative;
            display: inline-block;
            }
        .search-results {
            display: none;
            background-color: #fff;
            position: absolute;
            min-width: 100px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            }
        .search-results a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            }
        .search-results a:hover {background-color: #ddd;}
    </style>
</head>
<body>

    
    <nav class="navbar is-fixed-top" id="navBar" role="navigation" aria-label="main navigation" style="border-bottom:1px solid #d3d3d3">
        <div class="navbar-brand">
            <a class="navbar-item"><img src="https://xyli1905.github.io/img/signature-symbol.png"></a>
            <a class="navbar-item" href="https://xyli1905.github.io/">Home</a>
            <a class="navbar-item" href="https://xyli1905.github.io/about">About</a>
            <a class="navbar-item" href="https://github.com/xyli1905/DeepInfoFlow" target="_blank" rel="noopener noreferrer">DeepInfoFlow_Git</a>
            <a role="button" class="navbar-burger" onclick="document.querySelector('.navbar-menu').classList.toggle('is-active');" data-target="mainNavbar" aria-label="menu" aria-expanded="false">
                <span aria-hidden="true"></span> 
                <span aria-hidden="true"></span> 
                <span aria-hidden="true"></span>
                
            </a>
        </div>
        <div id="mainNavbar" class="navbar-menu">
            <div class="navbar-end">
                
                <div class="navbar-item" id="search">
                    <div id="baseurl" data-url="https://xyli1905.github.io/"></div>
                    <div :class="{'dropdown': true, 'is-active':showresult}">
                        <div class="dropdown-trigger">
                            <div class="control has-icons-right" aria-haspopup="true" aria-controls="dropdown-menu6">
                                <input class="input is-rounded" style="width: 287px;" type="text" placeholder="&#XF002; Search site..." v-model="txt" @keyup="search()" @blur="close()" maxlength="50">
                            </div>
                        </div>
                        <div class="dropdown-menu" id="dropdown-menu6" role="menu">
                            <div class="dropdown-content">
                                <div class="dropdown-item">
                                    <a v-for="item in result" :href="item.url" class="dropdown-item">{{ item.title }}</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    

    
    <section class="hero is-info is-medium">
        <div class="hero-body" style="background-image: url(https://xyli1905.github.io/img/calm.jpg); background-position: center center;">
            <div class="container has-text-centered">
                <br>
                <h1 class="title is-size-1">
                    
                        Response of Loss Functions to Label Noise (draft)
                    
                </h1>
                
                    
                
            </div>
        </div>
    </section>


<div class="container">
    <div class="section">
    

<header>
    <div class="columns">
        <div class="column is-9">
            <div class="title">
                <h1>Response of Loss Functions to Label Noise (draft)</h1>
            </div>
            <div class="meta">
                August 13, 2019 &middot;
                
                    <i class="fa fa-user" aria-hidden="true"></i> Xingyu Li &middot;
                
                
                    <i class="fa fa-sitemap" aria-hidden="true"></i>
                    
                        <span class="category"><a href="https://xyli1905.github.io/categories/noise-and-generalization">Noise and Generalization</a></span>
                    
                    &middot;
                
                
                    <i class="fa fa-tag" aria-hidden="true"></i>
                    
                        <span class="tag"><a href="https://xyli1905.github.io/tags/math">math</a></span>
                    
                        <span class="tag"><a href="https://xyli1905.github.io/tags/information-theory">information theory</a></span>
                    
                    
                
                
            </div>
        </div>
    </div>
</header>

<div class="columns">
    <div class="column is-9">
        <div class="tile is-child box">
            <div class="content">
                

<h2 id="distortion-on-dataset-distribution-by-nosie-labels">Distortion on dataset distribution by nosie labels</h2>

<p>Let $t$ and $t^*$ be the correct target label and the noisy label, respectively. Presently, we focus on binary classification and assume the label noise only depends on the correct label, i.e. the error rates are:</p>

<p>$$e _- = P(t^* = +1 | t= -1) \quad \text{and} \quad e _+ = P(t^*=-1|t=+1).$$</p>

<p>The noisy dataset defines the joint distribution $P(x, t^*)$, which relates to the clean distribution $P(x, t)$ through</p>

<p>$$\begin{aligned}P(x, t^*=+1) &amp;= (1 - e _+) * P(x, t=+1) + e _- * P(x, t= -1),\\ P(x, t^*=-1) &amp;= e _+ *P(x, t=+1) + (1 - e _-) * P(x, t= -1).\end{aligned}\tag{1}$$</p>

<p>For now, we will assume the model has been derived/trained somehow elsewhere. It will define a decision boundary $\partial _d$, which splits the feature space into two parts: one for $+1$ prediction, the other for $-1$. Let&rsquo;s denote these areas as $\Omega _+$ and $\Omega _-$, respectively. In order to distinguish from the clean and noisy label, we use $y$ to denote the predicted label by our model.</p>

<h2 id="mutual-information-loss">Mutual Information Loss</h2>

<p>Mutual information loss is defined as follow:</p>

<p>$$\mathcal{I}(Y; T) = \sum _{y,t} P(y, t)* \log \frac{P(y, t)}{P(y)P(t)},$$</p>

<p>where $P(y,t)$ can be calculated by</p>

<p>$$P(y=\pm 1, t) = \sum _{\Omega _{\pm}} P(x, t).$$</p>

<p>Now, take into account the noise on labels, then, for example</p>

<p>$$\begin{aligned}P(y= +1, t^* = +1) &amp;= \sum _{\Omega _+} P(x, t^*=+1)\\&amp;= \sum _{\Omega _+} [(1 - e _+) * P(x, t=+1) + e _- * P(x, t= -1)]\\ &amp;= (1 - e _+ - e _-)*\sum _{\Omega _+} P(x, t = +1) + e _- * P(y=+1)\\ &amp;=  \mathfrak{E}* P(y=+1, t = +1) + e _- * P(y=+1),\end{aligned}$$</p>

<p>at last step we set $(1 - e _+ - e _-) = \mathfrak{E}$ for simplicity. Generally, one has</p>

<p>$$P(y, t^* = \pm 1) =  \mathfrak{E} * P(y, t = \pm 1) + e _{\mp}* P(y),$$</p>

<p>or, with different symbols,</p>

<p>$$P(y, t^*) =  \mathfrak{E} * P(y, t) + e _{-t} * P(y),$$</p>

<p>where, assumed implicitly, $t^*$ and $t$ take the same value. Further, it follows</p>

<p>$$P(t^*) =  \mathfrak{E} * P(t) + e _{-t} .$$</p>

<p>Based on above, if the error rates are small, i.e. $e _\pm \sim 0 ^+$, one may approximate</p>

<p>$$\frac{P( y, t^* )}{ P(y) P(t^*)} \approx \frac{P(y, t)}{ P(y) P(t)},$$</p>

<p>As a result, the mutual information loss goes</p>

<p>$$\begin{aligned}\mathcal{I}(Y;T^*) &amp;\approx \sum _{y,t} [ \mathfrak{E} * P(y, t) + e _{-t}* P(y)] * \log \frac{P(y, t)}{P(y)P(t)}\\ &amp;= \mathcal{I}(Y; T) - (e _+ + e _-) * \mathcal{I}(Y; T) +  (e _+ + e _-)* H(Y) + \mathfrak{D}\\ &amp;= \mathcal{I}(Y; T) + (e _+ + e _-) * H(Y|T) + \mathfrak{D},\end{aligned}$$</p>

<p>where</p>

<p>$$\begin{aligned}\mathfrak{D} &amp;= \sum _{y,t} e  _{-t} * P(y) * \log P(y|t)\\ &amp;= \mathbb{E} _y \left[ \sum_t e  _{-t} * \log P(y|t) \right].\end{aligned}$$</p>

<h2 id="cross-entropy-loss-negative-log-likelihood-loss">Cross Entropy Loss / Negative Log-Likelihood Loss</h2>

<p>Cross entropy loss is usually defined as</p>

<p>$$L(Y, T) = \frac{1}{N} \sum_i \mathfrak{t}^i \cdot \log \mathfrak{y}^i.$$</p>

<p>Here, one adopts the one-hot encoding for training labels, $\mathfrak{t}^i$, and the model prediction, $\mathfrak{y}_i$, are probability vector for the input feature to be classified in each class, i.e. $\mathfrak{y} ^i _l = Q(c_l|x)$, where $c_l$ refers to the $l$&lsquo;th class and $Q$ emphasizes this probability is produced by our model. $N$ stands for the size of dataset.</p>

<p>Let&rsquo;s first consider the limit expression of this loss under $N\rightarrow \infty$. We claim</p>

<p>$$L(Y,T) \underset{N\rightarrow\infty}{\longrightarrow} \sum _{x, t} P(x)*P(t|x)\log Q(t|x).\tag{2}$$</p>

<p>Note that we have changed symbol for the target label, i.e. $t \in \{ -1,+1 \}$, which has the same meaning as in the previous section. $P$ refers to the empirical/true distribution of the dataset.</p>

<p>We also recognize that equation (2) is just the cross entropy between $P$ and $Q$ conditioned on $x$: $H(P,Q|X)$. Now, we can employ equation (1) to write down gthe response of cross entropy loss to the label noise. Note that $Q$ is solely determined by the model, one has</p>

<p>$$\begin{aligned}H(P^* ,Q | X) &amp;= \sum _{x, t^*} P(x) * P(t^* | x)\log Q(t^* | x)\\&amp;= \sum _{x, t} [\mathfrak{E}*P(x,t)+ e _{-t} * P(x)]*\log Q(t|x) \\ &amp;= \mathfrak{E} * H(P,Q | X) + \mathbb{E} _x \left[ \sum_t e _{-t} * \log Q(t|x)\right].\end{aligned}$$</p>

<p>In above, we use $H(P^*,Q|X)$ to indicate the conditional cross entropy on noisy data. One may rearrange terms to write the r.h.s. of above equation as</p>

<p>$$H(P,Q|X) - (e _+ + e _-) * H(P,Q) + \mathbb{E}_x \left[ \sum_t e _{-t} * \log Q(t,x) \right],$$</p>

<p>where</p>

<p>$$H(P,Q) = \sum _{x,t} P(x,t)\log Q(x,t)$$</p>

<p>and $Q(x,t) = Q(t|x)*P(x)$.</p>

            </div>
            <hr>
        </div>
        </br>
         
         <div class="tile is-child box">
            <div class="content has-text-grey-light" align="center">
                
                    there is still a long way to go
                
            </div>
        </div>
        
        
            <script src="https://utteranc.es/client.js"
                    repo="xyli1905/xyli1905.github.io"
                    issue-term="pathname"
                    theme="github-light"
                    crossorigin="anonymous"
                    async>
            </script>
        
    </div>
    <div id="comments-container"></div>
    <div class="column is-3">
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5"><i class="fa fa-file" aria-hidden="true"></i> Recent posts</h1>
        
            <h1><a href="https://xyli1905.github.io/2019/08/response-of-loss-function-to-label-noise/">Response of Loss Functions to Label Noise (draft)</a></h1>
            <time class="has-text-grey-light is-size-7">13 August 2019</time>
        
            <h1><a href="https://xyli1905.github.io/2019/08/bayes-classifier-and-mi-classifier-with-noisy-labels/">Bayes Classifier and MI Classifier With Noisy Labels</a></h1>
            <time class="has-text-grey-light is-size-7">8 August 2019</time>
        
            <h1><a href="https://xyli1905.github.io/2019/08/neural-tangent-kernel-and-nn-dynamics/">Neural Tangent Kernel and NN Dynamics (draft)</a></h1>
            <time class="has-text-grey-light is-size-7">1 August 2019</time>
        
            <h1><a href="https://xyli1905.github.io/2019/07/variational-form-for-hx/">Variational Form for H(x)</a></h1>
            <time class="has-text-grey-light is-size-7">29 July 2019</time>
        
            <h1><a href="https://xyli1905.github.io/2014/09/creating-a-new-theme/">Creating a New Theme</a></h1>
            <time class="has-text-grey-light is-size-7">28 September 2014</time>
        
    </div>
</div>
    <br>
        
  



<div class="card">
    <div class="card-content">
        <h1 class="title is-5"><i class="fa fa-file" aria-hidden="true"></i> Related posts</h1>
      
      
            <h1><a href="https://xyli1905.github.io/2019/08/bayes-classifier-and-mi-classifier-with-noisy-labels/">Bayes Classifier and MI Classifier With Noisy Labels</a></h1>
            <time class="has-text-grey-light is-size-7">8 August 2019</time>
      
            <h1><a href="https://xyli1905.github.io/2019/08/neural-tangent-kernel-and-nn-dynamics/">Neural Tangent Kernel and NN Dynamics (draft)</a></h1>
            <time class="has-text-grey-light is-size-7">1 August 2019</time>
      
            <h1><a href="https://xyli1905.github.io/2019/07/variational-form-for-hx/">Variational Form for H(x)</a></h1>
            <time class="has-text-grey-light is-size-7">29 July 2019</time>
      
    </div>
</div>

<br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5"><i class="fa fa-sitemap" aria-hidden="true"></i> Categories</h1>
        <div class="categories">
        
			
			<ul style="list-style: none;">
				<li class="category"><a href="https://xyli1905.github.io/categories/deepinfoflow">deepinfoflow</a> (1)</li>
			</ul>
        
			
			<ul style="list-style: none;">
				<li class="category"><a href="https://xyli1905.github.io/categories/hugo">hugo</a> (4)</li>
			</ul>
        
			
			<ul style="list-style: none;">
				<li class="category"><a href="https://xyli1905.github.io/categories/noise-and-generalization">noise-and-generalization</a> (3)</li>
			</ul>
        
        </div>          
    </div>
</div><br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5"><i class="fa fa-tag" aria-hidden="true"></i> Tags</h1>
        <div class="tags">
        
            <span class="tag"><a href="https://xyli1905.github.io/tags/dynamics">dynamics</a>(1)</span>
        
            <span class="tag"><a href="https://xyli1905.github.io/tags/information-theory">information-theory</a>(3)</span>
        
            <span class="tag"><a href="https://xyli1905.github.io/tags/math">math</a>(4)</span>
        
            <span class="tag"><a href="https://xyli1905.github.io/tags/neural-network">neural-network</a>(1)</span>
        
            <span class="tag"><a href="https://xyli1905.github.io/tags/review">review</a>(2)</span>
        
            <span class="tag"><a href="https://xyli1905.github.io/tags/templates">templates</a>(1)</span>
        
            <span class="tag"><a href="https://xyli1905.github.io/tags/themes">themes</a>(2)</span>
        
            <span class="tag"><a href="https://xyli1905.github.io/tags/tutorial">tutorial</a>(4)</span>
        
            <span class="tag"><a href="https://xyli1905.github.io/tags/variational-form">variational-form</a>(1)</span>
        
        </div>          
    </div>
</div><br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5"><i class="fa fa-archive" aria-hidden="true"></i> Archives</h1>
        
            <a href="https://xyli1905.github.io/archives/2019-08">2019-08</a> (3)<br>
        
            <a href="https://xyli1905.github.io/archives/2019-07">2019-07</a> (1)<br>
        
            <a href="https://xyli1905.github.io/archives/2014-09">2014-09</a> (1)<br>
        
            <a href="https://xyli1905.github.io/archives/2014-04">2014-04</a> (2)<br>
        
            <a href="https://xyli1905.github.io/archives/2014-03">2014-03</a> (1)<br>
        
    </div>
</div>
    </div>
</div>


    </div>
    
    <script src="https://unpkg.com/vanilla-back-to-top@7.2.0/dist/vanilla-back-to-top.min.js"></script>
    <script>addBackToTop({
        diameter: 56,
        backgroundColor: '#666',
        textColor: 'white'
    })</script>
</div>

<footer class="footer has-background-grey-darker has-text-white">
    <div class="content has-text-centered">
        <p>
            
            <span style="font-weight:bold">
            Go, wondrous creature! mount where science guides,  Go, measure earth, weigh air, and state the tides   — Alexander Pope, An Essay on Man
            </span>
            <br><br>
            <span style="font-weight:italic">
            Copyright &copy; Quanta 2019 - Theme by <a href="https://jeffprod.com" class="mysocial">JeffProd.com</a>
            - with Modifications
            </span>
            
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-145833346-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

        </p>
    </div>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.17/vue.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>

<script>
    let vuesearch = new Vue({
        el: '#search', 
        data: {
            txt: '', 
            timeoutID: 0, 
            showresult: false, 
            result: {}, 
            bdd: [] 
            },
        mounted: function() {
            
            axios.get('https:\/\/xyli1905.github.io\/search\/index.json')
            .then(function (response) {
                 vuesearch.bdd = response.data.results
                })
            .catch(function (error) {
                console.log(error);
                });
            },
        methods: {
            close: function() {
                
                
                setTimeout(function() {
                    vuesearch.showresult = false;
                    vuesearch.txt = '';
                    }, 300);
                },
            search: function() {
                
                clearTimeout(this.timeoutID);
                this.timeoutID = setTimeout(this.dosearch, 500);
                },
            dosearch: function() {
                
                this.result = []; 
                let words = this.txt.split(' '); 
                let words2 = []; 
                words.forEach(function(element) { 
                    if(element) {words2.push(element);}
                    });
                let r;
                let resultmp;
                console.log()
                words2.forEach(function(e) { 
                    r = vuesearch.bdd.filter(p => p.content.indexOf(e.toLowerCase()) !== -1);
                    
                    if(vuesearch.result.length===0) {vuesearch.result = r.slice(); return;}
                    resultmp = [];
                    vuesearch.result.forEach(function(all1) {
                        r.forEach(function(all2) { 
                            if(all1.url===all2.url) {resultmp.push(all1);}
                            });
                        });
                    vuesearch.result = resultmp.slice();
                    });
                this.result = this.result.slice(0, 10); 
                this.showresult = (this.result.length>0); 
            } 
        } 
    }); 
</script>
<script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>
</body>

<!doctype html>
<html>
<head>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js"></script>

</head>



<body>
    <script>
        renderMathInElement(
            document.body,
            {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false}
                ],
                newLineInDisplayMode: true
            }
        );
    </script>
</body>
</html>

</html>
